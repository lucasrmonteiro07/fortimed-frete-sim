<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lise de Erros - Simulador de Frete</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0e4370 0%, #1a5ba3 100%);
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        h1 {
            color: #0e4370;
            margin-bottom: 30px;
            text-align: center;
            font-size: 2.5em;
        }
        h2 {
            color: #1f5fa0;
            margin-top: 30px;
            margin-bottom: 20px;
            border-bottom: 3px solid #1f5fa0;
            padding-bottom: 10px;
        }
        .problem-card {
            background: #fff3cd;
            border-left: 5px solid #ff6b6b;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 6px;
        }
        .problem-card h3 {
            color: #d63031;
            margin-bottom: 10px;
        }
        .problem-card .status {
            display: inline-block;
            background: #d63031;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.9em;
            margin-bottom: 10px;
        }
        .code-example {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            overflow-x: auto;
        }
        .error {
            color: #d63031;
            font-weight: bold;
        }
        .correct {
            color: #27ae60;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        table th {
            background: #0e4370;
            color: white;
            padding: 12px;
            text-align: left;
        }
        table td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }
        table tr:hover {
            background: #f5f5f5;
        }
        .example-calc {
            background: #e8f4f8;
            border: 2px solid #1f5fa0;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .comparison-box {
            padding: 15px;
            border-radius: 6px;
            border: 2px solid;
        }
        .wrong {
            background: #ffebee;
            border-color: #d63031;
        }
        .correct-box {
            background: #e8f5e9;
            border-color: #27ae60;
        }
        .checklist {
            background: #f9f9f9;
            border-left: 5px solid #2ecc71;
            padding: 20px;
            border-radius: 6px;
        }
        .checklist ul {
            list-style: none;
            padding-left: 0;
        }
        .checklist li {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        .checklist li:before {
            content: "‚òê ";
            color: #2ecc71;
            font-weight: bold;
            margin-right: 10px;
        }
        .alert {
            background: #fff3cd;
            border: 2px solid #ff9800;
            color: #d63031;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-size: 1.1em;
        }
        .summary {
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 5px solid #d63031;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî¥ An√°lise Cr√≠tica: Erros no C√°lculo de Frete</h1>
        
        <div class="alert">
            ‚ö†Ô∏è <strong>CR√çTICO:</strong> O simulador est√° calculando valores incorretos em at√© 45% de diferen√ßa!
        </div>

        <!-- PROBLEMA 1 -->
        <div class="problem-card">
            <span class="status">‚ùå CR√çTICO #1</span>
            <h3>Tabela de Pre√ßos Desatualizada</h3>
            <p><strong>Problema:</strong> Todas as 23 zonas t√™m dados obsoletos que n√£o correspondem √† tabela oficial.</p>
            
            <strong>Dados Atuais (ERRADO):</strong>
            <div class="code-example">
SP1: { <span class="error">minimo: 10.50, porKg: 1.20</span> }
PR1: { <span class="error">minimo: 13.50, porKg: 1.40</span> }
RS1: { <span class="error">minimo: 15.00, porKg: 1.55</span> }
            </div>

            <strong>Deve Ser (CORRETO):</strong>
            <div class="code-example">
SP1: { <span class="correct">taxa: 70.82, freteQuilo: 1.152</span> }
PR1: { <span class="correct">taxa: 43.99, freteQuilo: 0.746</span> }
RS1: { <span class="correct">taxa: 26.44, freteQuilo: 0.481</span> }
            </div>
        </div>

        <!-- PROBLEMA 2 -->
        <div class="problem-card">
            <span class="status">‚ùå CR√çTICO #2</span>
            <h3>F√≥rmula de C√°lculo Incorreta</h3>
            <p><strong>Problema:</strong> N√£o est√° somando a TAXA fixa (valor base da zona).</p>
            
            <strong>C√≥digo Atual (ERRADO):</strong>
            <div class="code-example">
const frete = <span class="error">Math.max(precosZona.minimo, pesoNum * precosZona.porKg)</span>
            </div>

            <strong>Deve Ser (CORRETO):</strong>
            <div class="code-example">
const freteBase = <span class="correct">taxa + (peso √ó freteQuilo)</span>
// Depois somar: Ped√°gio + GRIS
            </div>
        </div>

        <!-- EXEMPLO PR√ÅTICO -->
        <h2>üìä Exemplo Pr√°tico: 100kg em SP1</h2>
        
        <div class="comparison">
            <div class="comparison-box wrong">
                <h4 style="color: #d63031;">‚ùå CALCULADO AGORA</h4>
                <p><strong>F√≥rmula:</strong> MAX(10.50, 100 √ó 1.20)</p>
                <p><strong>Resultado:</strong> <span class="error" style="font-size: 1.5em;">R$ 120.00</span></p>
                <p style="color: #999; font-size: 0.9em;">Faltando: Taxa + Ped√°gio + GRIS</p>
            </div>

            <div class="comparison-box correct-box">
                <h4 style="color: #27ae60;">‚úÖ DEVE SER</h4>
                <p><strong>Passo 1:</strong> 70.82 + (100 √ó 1.152) = R$ 186.02</p>
                <p><strong>Passo 2:</strong> Ped√°gio = 1 √ó 6.18 = R$ 6.18</p>
                <p><strong>Passo 3:</strong> GRIS = R$ 6.18</p>
                <p><strong>Total:</strong> <span class="correct" style="font-size: 1.5em;">R$ 198.38</span></p>
            </div>
        </div>

        <div class="alert" style="background: #ffebee; border-color: #d63031;">
            <strong>Diferen√ßa:</strong> -R$ 78,38 por frete (-39% menor do que deveria!) üî¥
        </div>

        <!-- PROBLEMA 3 -->
        <div class="problem-card">
            <span class="status">‚ùå CR√çTICO #3</span>
            <h3>Ped√°gio N√£o Implementado</h3>
            <p><strong>Problema:</strong> Est√° faltando o c√°lculo de ped√°gio.</p>
            
            <strong>F√≥rmula Correta:</strong>
            <div class="code-example">
Ped√°gio = <span class="correct">ceil(peso / 100) √ó valor</span>
- S√£o Paulo: R$ 6,18 por fra√ß√£o
- Demais: R$ 3,31 por fra√ß√£o
            </div>

            <strong>Exemplos:</strong>
            <table>
                <tr><td>50kg em SP</td><td>= 1 √ó 6.18 = R$ 6.18</td></tr>
                <tr><td>150kg em SP</td><td>= 2 √ó 6.18 = R$ 12.36</td></tr>
                <tr><td>250kg em PR</td><td>= 3 √ó 3.31 = R$ 9.93</td></tr>
            </table>
        </div>

        <!-- PROBLEMA 4 -->
        <div class="problem-card">
            <span class="status">‚ùå CR√çTICO #4</span>
            <h3>GRIS Calculado Incorretamente</h3>
            <p><strong>Problema:</strong> Est√° usando 2% fixo, deveria ser 0,20% SP / 0,15% demais com m√≠nimo.</p>
            
            <strong>C√≥digo Atual (ERRADO):</strong>
            <div class="code-example">
const percentualNota = <span class="error">0.02 // 2% ‚Üê ERRADO!</span>
const taxaNota = valorNotaNum * percentualNota
            </div>

            <strong>Deve Ser (CORRETO):</strong>
            <div class="code-example">
const grisPercentual = <span class="correct">isSP ? 0.0020 : 0.0015</span> // 0,20% ou 0,15%
const grisMinimo = <span class="correct">isSP ? 6.18 : 3.31</span>
const gris = <span class="correct">Math.max(valorNota * grisPercentual, grisMinimo)</span>
            </div>

            <strong>Exemplos:</strong>
            <table>
                <tr>
                    <td>Nota R$ 1.000 em SP</td>
                    <td>= MAX(1000 √ó 0,20%, 6.18) = MAX(2.00, 6.18) = <strong>R$ 6.18</strong></td>
                </tr>
                <tr>
                    <td>Nota R$ 5.000 em SP</td>
                    <td>= MAX(5000 √ó 0,20%, 6.18) = MAX(10.00, 6.18) = <strong>R$ 10.00</strong></td>
                </tr>
                <tr>
                    <td>Nota R$ 3.000 em PR</td>
                    <td>= MAX(3000 √ó 0,15%, 3.31) = MAX(4.50, 3.31) = <strong>R$ 4.50</strong></td>
                </tr>
            </table>
        </div>

        <!-- PROBLEMA 5 -->
        <div class="problem-card">
            <span class="status">‚ùå CR√çTICO #5</span>
            <h3>Acr√©scimos por Peso N√£o Implementados</h3>
            <p><strong>Problema:</strong> N√£o est√° calculando acr√©scimos para mercadorias pesadas.</p>
            
            <strong>Regras:</strong>
            <div class="code-example">
- 500kg at√© 1.000kg: +10% sobre frete base
- Acima de 1.000kg: +25% sobre frete base
            </div>

            <strong>Exemplo: 600kg em PR2</strong>
            <div class="example-calc">
1. Frete Base = 52.91 + (600 √ó 0.881) = R$ 581.01<br>
2. Acr√©scimo (+10%): 581.01 √ó 0.10 = R$ 58.10<br>
3. Frete com acr√©scimo = R$ 639.11
            </div>
        </div>

        <!-- PROBLEMA 6 -->
        <div class="problem-card">
            <span class="status">‚ùå CR√çTICO #6</span>
            <h3>Dados Regionais RS Incompletos</h3>
            <p><strong>Problema:</strong> 8 regi√µes do RS t√™m cidades desatualizadas/incompletas.</p>
            
            <strong>Exemplo - RS1 Atual (INCOMPLETO):</strong>
            <div class="code-example" style="max-height: 100px; overflow-y: auto;">
'Porto Alegre' ‚Üê Faltam cidades!
            </div>

            <strong>Deve Ser (COMPLETO):</strong>
            <div class="code-example" style="max-height: 150px; overflow-y: auto;">
'Regi√£o Metropolitana de Porto Alegre e Vale dos Sinos'
Porto Alegre, Canoas, Gravata√≠, Cachoeirinha, Esteio, 
Sapucaia do Sul, S√£o Leopoldo, Novo Hamburgo, Campo Bom, 
Est√¢ncia Velha, Ivoti, Dois Irm√£os, Feliz, etc.
            </div>
        </div>

        <!-- EXEMPLO COMPLEXO -->
        <h2>üìä Exemplo Complexo: 600kg em PR2, Nota R$ 1.500</h2>
        
        <div class="comparison">
            <div class="comparison-box wrong">
                <h4 style="color: #d63031;">‚ùå CALCULADO AGORA</h4>
                <p>Frete = MAX(15.00, 600 √ó 1.55)</p>
                <p>Frete = R$ 930.00</p>
                <p>Taxa = 1500 √ó 2% = R$ 30.00</p>
                <p style="font-size: 1.2em; color: #d63031; font-weight: bold;">TOTAL: R$ 960.00</p>
            </div>

            <div class="comparison-box correct-box">
                <h4 style="color: #27ae60;">‚úÖ DEVE SER</h4>
                <p>Frete Base = 52.91 + (600√ó0.881) = R$ 581.01</p>
                <p>Acr√©scimo +10% = R$ 58.10</p>
                <p>Ped√°gio = 6 √ó 3.31 = R$ 19.86</p>
                <p>GRIS = MAX(1500√ó0.15%, 3.31) = R$ 4.50</p>
                <p style="font-size: 1.2em; color: #27ae60; font-weight: bold;">TOTAL: R$ 663.47</p>
            </div>
        </div>

        <div class="alert" style="background: #ffebee; border-color: #d63031;">
            <strong>Diferen√ßa:</strong> +R$ 296,53 a mais do que deveria! (-31% menor!) üî¥
        </div>

        <!-- CHECKLIST -->
        <h2>‚úÖ Checklist de Corre√ß√µes</h2>
        <div class="checklist">
            <ul>
                <li>Atualizar 23 zonas com Taxa (R$) e Frete/kg corretos</li>
                <li>Atualizar 8 regi√µes RS com cidades detalhadas</li>
                <li>Implementar nova f√≥rmula: Taxa + (Peso √ó Frete/kg)</li>
                <li>Implementar c√°lculo de Ped√°gio</li>
                <li>Corrigir GRIS (0,20% SP / 0,15% demais com m√≠nimo)</li>
                <li>Implementar acr√©scimos 500-1000kg (+10%) e >1000kg (+25%)</li>
                <li>Testar com exemplos reais</li>
                <li>Validar interface para mostrar breakdown completo</li>
            </ul>
        </div>

        <!-- RESUMO -->
        <h2>üö® Resumo Executivo</h2>
        <div class="summary">
            <strong>Status:</strong> ‚ùå CR√çTICO<br>
            <strong>Erros Encontrados:</strong> 6 cr√≠ticos<br>
            <strong>Impacto:</strong> Cota√ß√µes est√£o 30-45% incorretas<br>
            <strong>Urg√™ncia:</strong> üî¥ Corrigir IMEDIATAMENTE antes de usar em produ√ß√£o<br>
            <strong>Tempo Estimado para Corre√ß√£o:</strong> ~1 hora
        </div>
    </div>
</body>
</html>
